# funcs


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Path normalization

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L23"
target="_blank" style="float:right; font-size:smaller">source</a>

### normalize_path

>  normalize_path (path:Union[str,pathlib.Path,NoneType],
>                      base:pathlib.Path|None=None)

\*Expand user, resolve against base when relative.

Parameters: path: Path to normalize (string or Path). If None, returns
base or cwd. base: Base path to resolve relative paths against.

Returns: Resolved absolute Path.\*

``` python
# Test normalize_path
assert normalize_path(None) == Path.cwd()
assert normalize_path("foo", Path("/base")) == Path("/base/foo")
assert normalize_path("/abs/path", Path("/base")) == Path("/abs/path")
print("normalize_path tests passed")
```

## Extension handling

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L43"
target="_blank" style="float:right; font-size:smaller">source</a>

### ensure_extension

>  ensure_extension (name:str, ext:str|None)

\*Ensure filename has the given extension.

Extension may be provided with or without leading dot. Returns unchanged
name if ext is None/empty.

Parameters: name: Base filename. ext: Extension to ensure (with or
without leading dot).

Returns: Filename with proper extension.\*

``` python
# Test ensure_extension
assert ensure_extension("model", ".ckpt") == "model.ckpt"
assert ensure_extension("model", "ckpt") == "model.ckpt"  # without dot
assert ensure_extension("model.ckpt", ".ckpt") == "model.ckpt"  # already has it
assert ensure_extension("model.old", ".ckpt") == "model.ckpt"  # replace ext
assert ensure_extension("model", None) == "model"  # no ext
assert ensure_extension("model", "") == "model"  # empty ext
print("ensure_extension tests passed")
```

## Datestamp formatting and parsing

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L66"
target="_blank" style="float:right; font-size:smaller">source</a>

### format_datestamp

>  format_datestamp (dt:datetime.datetime|None, fmt:str)

\*Format datetime to datestamp string.

Parameters: dt: Datetime to format. Uses now() if None. fmt: strftime
format string.

Returns: Formatted datestamp string.\*

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L79"
target="_blank" style="float:right; font-size:smaller">source</a>

### parse_datestamp

>  parse_datestamp (text:str, fmt:str)

\*Parse datestamp string to datetime.

Parameters: text: Datestamp string to parse. fmt: strftime format string
used to create the datestamp.

Returns: Parsed datetime object.

Raises: ValueError: If text doesn’t match the format.\*

``` python
# Test datestamp functions
from datetime import datetime
dt = datetime(2024, 3, 15)
assert format_datestamp(dt, "%Y_%m_%d") == "2024_03_15"
assert parse_datestamp("2024_03_15", "%Y_%m_%d") == datetime(2024, 3, 15)

# Test error message
try:
    parse_datestamp("bad", "%Y_%m_%d")
    assert False, "Should have raised"
except ValueError as e:
    assert "Cannot parse 'bad'" in str(e)
print("datestamp tests passed")
```

    datestamp tests passed

## Tree rendering

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L98"
target="_blank" style="float:right; font-size:smaller">source</a>

### build_tree

>  build_tree (root:pathlib.Path, max_depth:int=4, files:bool=False)

\*Build ASCII directory tree representation.

Parameters: root: Root directory to start from. max_depth: Maximum depth
to descend (default 4). files: If True, include files; otherwise only
directories.

Returns: ASCII tree string.\*

``` python
# Test build_tree with a simple example
import tempfile, os
with tempfile.TemporaryDirectory() as tmp:
    root = Path(tmp) / "test_root"
    (root / "subdir1").mkdir(parents=True)
    (root / "subdir2").mkdir(parents=True)
    (root / "subdir1" / "nested").mkdir()
    (root / "file.txt").touch()
    
    # Dirs only
    tree = build_tree(root, max_depth=2, files=False)
    assert "subdir1" in tree
    assert "nested" in tree
    assert "file.txt" not in tree
    
    # With files
    tree_with_files = build_tree(root, max_depth=2, files=True)
    assert "file.txt" in tree_with_files
print("build_tree tests passed")
```

    build_tree tests passed

## Gitignore handling

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L132"
target="_blank" style="float:right; font-size:smaller">source</a>

### render_gitignore

>  render_gitignore (existing_text:str, entries:Iterable[str])

\*Add entries to gitignore text, avoiding duplicates.

Parameters: existing_text: Current gitignore content. entries: New
entries to add.

Returns: Updated gitignore text with new entries appended.\*

``` python
# Test render_gitignore
existing = "*.pyc\n__pycache__/\n"
result = render_gitignore(existing, ["checkpoints/", "logs/"])
assert "checkpoints/" in result
assert "logs/" in result
assert result.count("*.pyc") == 1  # not duplicated

# Idempotent
result2 = render_gitignore(result, ["checkpoints/", "logs/"])
assert result2 == result
print("render_gitignore tests passed")
```

## Template specification

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L154"
target="_blank" style="float:right; font-size:smaller">source</a>

### TemplateSpec

>  TemplateSpec (name:str,
>                    base:Union[str,pathlib.Path,Callable[[Any],pathlib.Path]],
>                    pattern:Union[Sequence[str],Mapping[str,str]],
>                    root:str='outputs', datestamp:bool|None=None,
>                    create:bool|None=None)

\*Specification for a path template.

Attributes: name: Template name for registration/lookup. base: Base path
or callable returning base path from ProjectIO. pattern: Sequence of
path parts or mapping of key-\>filename. root: Which root to resolve
relative base against (‘inputs’, ‘outputs’, ‘cache’, ‘custom’).
datestamp: Override datestamp behavior (None uses instance default).
create: Override auto_create behavior (None uses instance default).\*

## Template resolution

------------------------------------------------------------------------

<a
href="https://github.com/s01st/project-io/blob/main/projio/funcs.py#L191"
target="_blank" style="float:right; font-size:smaller">source</a>

### resolve_template

>  resolve_template (spec:__main__.TemplateSpec, io:Any, variant:str|None,
>                        fmt:Mapping[str,str], datestamp:bool|None,
>                        timestamp:datetime.datetime|None)

\*Resolve a template spec to concrete path(s).

Parameters: spec: Template specification. io: ProjectIO instance for
context. variant: Optional variant name (e.g., run/model name). fmt:
Format placeholders for pattern. datestamp: Override datestamp behavior.
timestamp: Specific timestamp for datestamp.

Returns: Single Path if pattern is a sequence, or dict of Paths if
pattern is a mapping.\*
